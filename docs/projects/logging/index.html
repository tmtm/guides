<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Projects: ロギング | Hanami Guides" />

    <meta property="og:url"          content="https://tmtm.github.io/hanami-guides/projects/logging/" />
    <meta property="og:type"         content="article" />
    <meta property="og:locale"       content="en_US" />
    <meta property="og:site_name"    content="Hanami Guides" />
    <meta property="og:title"        content="Projects: ロギング | Hanami Guides" />
    <meta property="og:description"  content="Projects: ロギング | Hanami Guides" />
    <meta property="og:image"        content="https://tmtm.github.io/assets/img/brand/hanami-guides-social.png" />
    <meta property="og:image:type"   content="image/png" />
    <meta property="og:image:width"  content="2968" />
    <meta property="og:image:height" content="2968" />
    <meta property="og:image:alt"    content="" />

    <meta name="twitter:card"        content="summary" />
    <meta name="twitter:site"        content="@hanamirb" />
    <meta name="twitter:creator"     content="@hanamirb" />
    <meta name="twitter:title"       content="Projects: ロギング | Hanami Guides" />
    <meta name="twitter:description" content="Projects: ロギング | Hanami Guides" />
    <meta name="twitter:image"       content="https://tmtm.github.io/assets/img/brand/hanami-guides-social.png" />

    <title>Projects: ロギング | Hanami Guides</title>

    <meta name="author" content="Hanami team">
    <meta name="keywords" content="hanami,hanamirb,hanami guides,documentation,lotus,lotusrb,web,framework,ruby,open source,oss,os,software,free,free software,architecture,fast,lightweight,testing,tdd,bdd,test driven development,behaviour driven development,full stack,mvc,model view object,pattern,patterns,design patterns,oop,object oriented programming,testability,http,https,routing,router,http router,restful,resource,resources,convention,controller,models,repository,query,sql,interactors,two-step view,view,template,presenters,render,rendering,helpers,erb,haml,tilt,json,xml,yaml,yml,framwork,framewrok,riby,free sowftare" />
    
    <link rel="shortcut icon" href="/hanami-guides/assets/img/brand/favicon.ico">
    
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    
    <link href="/hanami-guides/assets/vendor/nucleo/css/nucleo.css" rel="stylesheet">
    <link href="/hanami-guides/assets/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    
    <link type="text/css" href="/hanami-guides/assets/css/argon.css?v=1.0.1" rel="stylesheet">
    
    <link type="text/css" href="/hanami-guides/assets/css/docs.min.css" rel="stylesheet">
    
    <link type="text/css" href="/hanami-guides/assets/css/theme.css" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
  </head>
  <body data-spy="scroll" data-target="#secondary-navigation" data-offset="50">
    <header class="navbar navbar-expand navbar-dark flex-row align-items-md-center ct-navbar">
      <a class="navbar-brand mr-0 mr-md-2" href="/hanami-guides/" aria-label="Bootstrap">
      <img src="/hanami-guides/assets/img/brand/white.png" alt="Hanami guides logo">
    </a>
    <ul class="navbar-nav flex-row mr-auto ml-4 d-none d-md-flex">
      <li class="nav-item">
        <form>
          <input type="text" placeholder="Search" class="form-control" id="search-input" />
        </form>
      </li>
    </ul>
    <div class="d-none d-sm-block ml-auto">
      <ul class="navbar-nav ct-navbar-nav flex-row align-items-center">
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="http://hanamirb.org" target="_blank" title="Hanami website">
            <i class="ni ni-world"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://github.com/hanami/guides/edit//content/projects/logging.md" target="_blank" title="Edit this page">
            <i class="fa fa-pencil-square-o"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://github.com/hanami/hanami" target="_blank" title="Star Hanami on GitHub">
            <i class="fa fa-github"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://twitter.com/hanamirb" target="_blank" title="Follow Hanami on Twitter">
            <i class="fa fa-twitter"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://www.facebook.com/hanamirb" target="_blank" title="Like Hanami on Facebook">
            <i class="fa fa-facebook-square"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://www.instagram.com/hanamirb" target="_blank" title="Follow Hanami on Instagram">
            <i class="fa fa-instagram"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="http://chat.hanamirb.org/" target="_blank" title="Hanami chat">
            <i class="ni ni-chat-round"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link nav-link-icon" href="https://github.com/hanami/guides/releases" target="_blank" title="Download Hanami Guides for offline usage">
            <i class="fa fa-cloud-download"></i>
          </a>
        </li>
        <li class="nav-item">
          <span class="badge badge-pill badge-primary">v1.3.1</span>
        </li>
      </ul>
    </div>
  </header>
  <div class="container-fluid">
    <div class="row flex-xl-nowrap">
      <div class="col-12 col-md-3 col-xl-2 ct-sidebar">
        <nav class="collapse ct-links" id="ct-docs-nav">
          
          <div class="ct-toc-item active">
          
          
            <span class="ct-toc-link">Introduction</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/introduction/getting-started/">はじめに</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Architecture</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/architecture/overview/">概要</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/architecture/interactors/">インタラクター</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Projects</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/projects/code-reloading/">コードのリロード</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/rake/">Rakeタスク</a>
              </li>
            
              
              <li class="active ct-sidenav-active">
              
                <a href="/hanami-guides/projects/logging/">ロギング</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/initializers/">Initializers</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/rack-middleware/">Rack Middleware</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/security/">Project Security</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/http2-early-hints/">HTTP/2 Early Hints</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/projects/selectively-boot-apps/">Selectively boot apps</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Routing</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/routing/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/routing/basic-usage/">Basic Usage</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/routing/restful-resources/">RESTful Resource(s)</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/routing/testing/">Testing</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Actions</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/actions/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/basic-usage/">Basic Usage</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/parameters/">Parameters</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/request-and-response/">Request &amp; Response</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/exposures/">Exposures</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/rack-integration/">Rack Integration</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/mime-types/">MIME Types</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/cookies/">Cookies</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/sessions/">Sessions</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/exception-handling/">Exception Handling</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/control-flow/">Control Flow</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/http-caching/">HTTP Caching</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/share-code/">Share Code</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/actions/testing/">Testing</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Views</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/views/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/basic-usage/">Basic Usage</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/templates/">Templates</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/mime-types/">MIME Types</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/layouts/">Layouts</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/custom-error-pages/">Custom Error Pages</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/share-code/">Share Code</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/views/testing/">Testing</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Models</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/models/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/models/database-configuration/">Database Configuration</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/models/use-your-own-orm/">Use Your Own ORM</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Repositories</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/repositories/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/repositories/sql-queries/">SQL Queries</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/repositories/postgresql/">PostgreSQL</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Entities</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/entities/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/entities/custom-schema/">Custom Schema</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/entities/data-types/">Data Types</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Associations</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/associations/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/associations/has-many/">Has Many</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/associations/belongs-to/">Belongs To</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/associations/has-one/">Has One</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/associations/has-many-through/">Has Many Through</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Migrations</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/migrations/overview/">Migrations</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/migrations/create-table/">Create Table</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/migrations/alter-table/">Alter Table</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Validations</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/validations/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/validations/boolean-logic/">Boolean Logic</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/validations/custom-predicates/">Custom Predicates</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/validations/advanced-usage/">Advanced Usage</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Helpers</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/helpers/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/html5/">HTML5</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/forms/">Forms</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/routing/">Routing</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/assets/">Assets</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/links/">Links</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/escape/">Markup Escape</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/numbers/">Numbers</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/helpers/custom-helpers/">Custom Helpers</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Mailers</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/mailers/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/mailers/basic-usage/">Basic Usage</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/mailers/templates/">Templates</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/mailers/delivery/">Delivery</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/mailers/share-code/">Share Code</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/mailers/testing/">Testing</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Assets</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/assets/overview/">Overview</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/assets/preprocessors/">Preprocessors</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/assets/compressors/">Compressors</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/assets/content-delivery-network/">Content Delivery Network (CDN)</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/assets/use-your-own-assets-management-tool/">Use Your Own Assets Management</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Command Line</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/command-line/project/">Project</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/generators/">Generators</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/destroy/">Destroy</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/database/">Database</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/assets/">Assets</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/routes/">Routes</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/version/">Version</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/command-line/plugins/">Plugins</a>
              </li>
            
            </ul>
          
          
            <span class="ct-toc-link">Upgrade Notes</span>
            <ul class="nav ct-sidenav">
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v060/">v0.6.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v070/">v0.7.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v080/">v0.8.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v090/">v0.9.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v100/">v1.0.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v110/">v1.1.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v120/">v1.2.0</a>
              </li>
            
              
              <li>
              
                <a href="/hanami-guides/upgrade-notes/v130/">v1.3.0</a>
              </li>
            
            </ul>
          
          </div>
        </nav>
      </div>
      <div class="d-none d-xl-block col-xl-2 ct-toc">
        <ul class="section-nav" id="secondary-navigation">
        
        
          
          
          <li class="toc-entry toc-h2">
            <a href="#%e6%a9%9f%e5%af%86%e6%83%85%e5%a0%b1%e3%81%ae%e3%83%95%e3%82%a3%e3%83%ab%e3%82%bf" class="nav-link">機密情報のフィルタ</a>
          </li>
        
          
          
          <li class="toc-entry toc-h2">
            <a href="#%e4%bb%bb%e6%84%8f%e3%81%ae%e5%bc%95%e6%95%b0" class="nav-link">任意の引数</a>
          </li>
        
          
          
          <li class="toc-entry toc-h2">
            <a href="#%e8%87%aa%e5%8b%95%e3%83%ad%e3%82%ae%e3%83%b3%e3%82%b0" class="nav-link">自動ロギング</a>
          </li>
        
          
          
          <li class="toc-entry toc-h2">
            <a href="#%e3%82%ab%e3%82%b9%e3%82%bf%e3%83%a0%e3%83%ad%e3%82%ac%e3%83%bc" class="nav-link">カスタムロガー</a>
          </li>
        
          
          
          <li class="toc-entry toc-h2">
            <a href="#%e8%89%b2%e4%bb%98%e3%81%91" class="nav-link">色付け</a>
          </li>
        
        </ul>
      </div>
      <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 ct-content">
        <div class="ct-page-title">
          <h1 class="ct-title" id="content">Projects: ロギング</h1>
          <div class="avatar-group mt-3">
          </div>
        </div>
        <hr>
        

<p>各プロジェクトは<code>Hanami.logger</code>で利用可能なグローバルロガーを持っています。これは次のように使用できます: <code>Hanami.logger.debug &quot;Hello&quot;</code></p>

<p>それは<code>config/environment.rb</code>で設定することが出来ます。</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:development</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span>
  <span style="color:#00a8c8">end</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:production</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span><span style="color:#111">,</span> <span style="color:#d88200">formatter</span><span style="color:#111">:</span> <span style="color:#d88200">:json</span>

    <span style="color:#75715e"># ...</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<p>ほとんどのホスティングSaaS企業が<a href="https://devcenter.heroku.com/articles/rails4#logging-and-assets">推奨</a>する<a href="http://12factor.net/logs">ベストプラクティス</a>であるため、デフォルトでは標準出力が使用されます。</p>

<p>ファイルを使いたい場合は、<code>stream: 'path/to/file.log'</code>をオプションとして渡します。</p>

<h2 id="機密情報のフィルタ">機密情報のフィルタ</h2>

<p>Hanamiは自動的に非GET HTTPリクエストの本体をログに記録します。</p>

<p>ユーザーがフォームを送信すると、すべてのフィールドとその値がログに現れます:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-log" data-lang="log">[bookshelf] [INFO] [2017-08-11 18:17:54 +0200] HTTP/1.1 POST 302 ::1 /signup 5 {&#34;signup&#34;=&gt;{&#34;username&#34;=&gt;&#34;jodosha&#34;, &#34;password&#34;=&gt;&#34;secret&#34;, &#34;password_confirmation&#34;=&gt;&#34;secret&#34;, &#34;bio&#34;=&gt;&#34;lorem&#34;}} 0.00593</code></pre></div>
<p>機密情報がログに記録されるのを防ぐために、それらをフィルタリングすることができます:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>
  <span style="color:#111">environment</span> <span style="color:#d88200">:development</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:debug</span><span style="color:#111">,</span> <span style="color:#d88200">filter</span><span style="color:#111">:</span> <span style="color:#d88200">%w[password password_confirmation]</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<p>出力は次のようになります:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-log" data-lang="log">[bookshelf] [INFO] [2017-08-11 18:17:54 +0200] HTTP/1.1 POST 302 ::1 /signup 5 {&#34;signup&#34;=&gt;{&#34;username&#34;=&gt;&#34;jodosha&#34;, &#34;password&#34;=&gt;&#34;[FILTERED]&#34;, &#34;password_confirmation&#34;=&gt;&#34;[FILTERED]&#34;, &#34;bio&#34;=&gt;&#34;lorem&#34;}} 0.00593</code></pre></div>
<p>同じ名前のパラメータを明確にするためのきめ細かいパターンもサポートしています。
たとえば、ストリート番号とクレジットカード番号を含む請求フォームがあり、クレジットカードのみをフィルタリングたい場合:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>
  <span style="color:#111">environment</span> <span style="color:#d88200">:development</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:debug</span><span style="color:#111">,</span> <span style="color:#d88200">filter</span><span style="color:#111">:</span> <span style="color:#d88200">%w[credit_card.number]</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-log" data-lang="log">[bookshelf] [INFO] [2017-08-11 18:43:04 +0200] HTTP/1.1 PATCH 200 ::1 /billing 2 {&#34;billing&#34;=&gt;{&#34;name&#34;=&gt;&#34;Luca&#34;, &#34;address&#34;=&gt;{&#34;street&#34;=&gt;&#34;Centocelle&#34;, &#34;number&#34;=&gt;&#34;23&#34;, &#34;city&#34;=&gt;&#34;Rome&#34;}, &#34;credit_card&#34;=&gt;{&#34;number&#34;=&gt;&#34;[FILTERED]&#34;}}} 0.009782</code></pre></div>
<p><code>billing =&gt; address =&gt; number</code> はフィルタされず、代わりに <code>billing =&gt; credit_card =&gt; number</code> がフィルタされたことに注意してください。</p>

<p>本体のログを完全に無効にしたい場合は、カスタムフォーマッタを使用すると簡単に実現できます:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#00a8c8">class</span> <span style="color:#75af00">NoParamsFormatter</span> <span style="color:#f92672">&lt;</span> <span style="color:#f92672">::</span><span style="color:#00a8c8">Hanami</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Logger</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Formatter</span>
  <span style="color:#00a8c8">def</span> <span style="color:#75af00">_format</span><span style="color:#111">(</span><span style="color:#111">hash</span><span style="color:#111">)</span>
    <span style="color:#111">hash</span><span style="color:#f92672">.</span><span style="color:#111">delete</span> <span style="color:#d88200">:params</span>
    <span style="color:#00a8c8">super</span> <span style="color:#111">hash</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<p>そして、loggerに新しいフォーマッタを使ってロギングするように伝えるだけです</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:debug</span><span style="color:#111">,</span> <span style="color:#d88200">formatter</span><span style="color:#111">:</span> <span style="color:#00a8c8">NoParamsFormatter</span><span style="color:#f92672">.</span><span style="color:#111">new</span></code></pre></div>
<h2 id="任意の引数">任意の引数</h2>

<p>Rubyの<code>Logger</code>と互換性のある<a href="https://ruby-doc.org/stdlib/libdoc/logger/rdoc/Logger.html#class-Logger-label-How+to+create+a+logger">任意の引数</a>を指定できます。</p>

<p>毎日のログローテーションを設定する方法は次のとおりです:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:production</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">&#39;daily&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span><span style="color:#111">,</span> <span style="color:#d88200">formatter</span><span style="color:#111">:</span> <span style="color:#d88200">:json</span><span style="color:#111">,</span> <span style="color:#d88200">stream</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;log/production.log&#39;</span>

    <span style="color:#75715e"># ...</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<p>あるいは、ファイル数(<code>10</code>としましょう)と各ファイルのサイズ(例: <code>1,024,000</code>バイト、<code>1</code>メガバイト)に制限を設けることもできます:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:production</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#ae81ff">10</span><span style="color:#111">,</span> <span style="color:#ae81ff">1_024_000</span><span style="color:#111">,</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span><span style="color:#111">,</span> <span style="color:#d88200">formatter</span><span style="color:#111">:</span> <span style="color:#d88200">:json</span><span style="color:#111">,</span> <span style="color:#d88200">stream</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;log/production.log&#39;</span>

    <span style="color:#75715e"># ...</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<h2 id="自動ロギング">自動ロギング</h2>

<p>すべてのHTTP要求、SQL照会、およびデータベース操作は自動的にロギングされます。</p>

<p>プロジェクトが開発モードで使用されている場合、ロギング形式は人間が判読可能です:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#f92672">[</span><span style="color:#111">bookshelf</span><span style="color:#f92672">]</span> <span style="color:#f92672">[</span><span style="color:#00a8c8">INFO</span><span style="color:#f92672">]</span> <span style="color:#f92672">[</span><span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span> <span style="color:#ae81ff">15</span><span style="color:#111">:</span><span style="color:#ae81ff">42</span><span style="color:#111">:</span><span style="color:#ae81ff">48</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">0100</span><span style="color:#f92672">]</span> <span style="color:#00a8c8">HTTP</span><span style="color:#d88200">/1.1 GET 200 127.0.0.1 /</span><span style="color:#111">books</span><span style="color:#d88200">/1  451 0.018576
</span><span style="color:#d88200">[bookshelf] [INFO] [2017-02-11 15:42:48 +0100] (0.000381s) SELECT &#34;id&#34;, &#34;title&#34;, &#34;created_at&#34;, &#34;updated_at&#34; FROM &#34;books&#34; WHERE (&#34;book&#34;.&#34;id&#34; = &#39;1&#39;) ORDER BY &#34;books&#34;.&#34;id&#34;</span></code></pre></div>
<p>プロダクション環境の場合、デフォルトのフォーマットはJSONです。
JSONは解析可能で、よりマシン指向です。ログ収集やSaaSロギング製品に最適です。</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#111">{</span><span style="color:#f92672">&#34;app&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;bookshelf&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;severity&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;INFO&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;time&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;2017-02-10T22:31:51Z&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;http&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;HTTP/1.1&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;verb&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;GET&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;status&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;200&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;ip&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;127.0.0.1&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;path&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;/books/1&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;query&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;length&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;451&#34;</span><span style="color:#111">,</span><span style="color:#f92672">&#34;elapsed&#34;</span><span style="color:#111">:</span><span style="color:#ae81ff">0.000391478</span><span style="color:#111">}</span></code></pre></div>
<h2 id="カスタムロガー">カスタムロガー</h2>

<p>異なるロギング動作が必要な場合は、カスタムロガーを指定できます。たとえば、<a href="https://github.com/timberio/timber-ruby">Timberロガー</a>:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:production</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#00a8c8">Timber</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Logger</span><span style="color:#f92672">.</span><span style="color:#111">new</span><span style="color:#111">(</span><span style="color:#00a8c8">STDOUT</span><span style="color:#111">)</span>

    <span style="color:#75715e"># ...</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<p><code>Hanami.logger</code>経由で通常通りこのロガーを使用してください。選択されたどのロガーもデフォルトの<code>::Logger</code>インターフェースに準拠しなければならないことに注意することが重要です。</p>

<h2 id="色付け">色付け</h2>

<h3 id="色付けを無効にする">色付けを無効にする</h3>

<p>色付けを無効にするには:</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:development</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span><span style="color:#111">,</span> <span style="color:#d88200">colorizer</span><span style="color:#111">:</span> <span style="color:#00a8c8">false</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div>
<h3 id="カスタム色付け">カスタム色付け</h3>

<p>あなたはあなた自身の色付け戦略を構築することができます</p>
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/environment.rb</span>
<span style="color:#75715e"># ...</span>
<span style="color:#111">require_relative</span> <span style="color:#d88200">&#34;./logger_colorizer&#34;</span>

<span style="color:#00a8c8">Hanami</span><span style="color:#f92672">.</span><span style="color:#111">configure</span> <span style="color:#00a8c8">do</span>
  <span style="color:#75715e"># ...</span>

  <span style="color:#111">environment</span> <span style="color:#d88200">:development</span> <span style="color:#00a8c8">do</span>
    <span style="color:#111">logger</span> <span style="color:#d88200">level</span><span style="color:#111">:</span> <span style="color:#d88200">:info</span><span style="color:#111">,</span> <span style="color:#d88200">colorizer</span><span style="color:#111">:</span> <span style="color:#00a8c8">LoggerColorizer</span><span style="color:#f92672">.</span><span style="color:#111">new</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div><div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># config/logger_colorizer.rb</span>
<span style="color:#111">require</span> <span style="color:#d88200">&#34;hanami/logger&#34;</span>
<span style="color:#111">require</span> <span style="color:#d88200">&#34;paint&#34;</span> <span style="color:#75715e"># gem install paint</span>

<span style="color:#00a8c8">class</span> <span style="color:#75af00">LoggerColorizer</span> <span style="color:#f92672">&lt;</span> <span style="color:#00a8c8">Hanami</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Logger</span><span style="color:#f92672">::</span><span style="color:#00a8c8">Colorizer</span>
  <span style="color:#00a8c8">def</span> <span style="color:#75af00">initialize</span><span style="color:#111">(</span><span style="color:#d88200">colors</span><span style="color:#111">:</span> <span style="color:#111">{</span> <span style="color:#d88200">app</span><span style="color:#111">:</span> <span style="color:#f92672">[</span><span style="color:#d88200">:red</span><span style="color:#111">,</span> <span style="color:#d88200">:bright</span><span style="color:#f92672">]</span><span style="color:#111">,</span> <span style="color:#d88200">severity</span><span style="color:#111">:</span> <span style="color:#f92672">[</span><span style="color:#d88200">:red</span><span style="color:#111">,</span> <span style="color:#d88200">:blue</span><span style="color:#f92672">]</span><span style="color:#111">,</span> <span style="color:#d88200">datetime</span><span style="color:#111">:</span> <span style="color:#f92672">[</span><span style="color:#d88200">:italic</span><span style="color:#111">,</span> <span style="color:#d88200">:yellow</span><span style="color:#f92672">]</span> <span style="color:#111">})</span>
    <span style="color:#00a8c8">super</span>
  <span style="color:#00a8c8">end</span>

  <span style="color:#00a8c8">private</span>

  <span style="color:#00a8c8">def</span> <span style="color:#75af00">colorize</span><span style="color:#111">(</span><span style="color:#111">message</span><span style="color:#111">,</span> <span style="color:#d88200">color</span><span style="color:#111">:)</span>
    <span style="color:#00a8c8">Paint</span><span style="color:#f92672">[</span><span style="color:#111">message</span><span style="color:#111">,</span> <span style="color:#f92672">*</span><span style="color:#111">color</span><span style="color:#f92672">]</span>
  <span style="color:#00a8c8">end</span>
<span style="color:#00a8c8">end</span></code></pre></div><hr>
        <div class="container">
          <div class="row">
            <div class="col">
              
              <a href="/hanami-guides/projects/rake/">
                <button class="btn btn-icon btn-3 btn-outline-primary" type="button">
                  <span class="btn-inner--icon"><i class="ni ni-bold-left"></i></span>
                  <span class="btn-inner--text">Projects: Rakeタスク</span>
                </button>
              </a>
              
            </div>
            <div class="col text-align-right">
              
              <a href="/hanami-guides/projects/initializers/">
                <button class="btn btn-icon btn-3 btn-outline-primary" type="button">
                  <span class="btn-inner--text">Projects: Initializers</span>
                  <span class="btn-inner--icon"><i class="ni ni-bold-right"></i></span>
                </button>
              </a>
              
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>
  
  <script src="/hanami-guides/assets/vendor/jquery/jquery.min.js"></script>
  <script src="/hanami-guides/assets/vendor/popper/popper.min.js"></script>
  <script src="/hanami-guides/assets/vendor/bootstrap/bootstrap.min.js"></script>
  <script src="/hanami-guides/assets/vendor/headroom/headroom.min.js"></script>
  <script src="/hanami-guides/assets/vendor/clipboard/clipboard.min.js"></script>
  
  <script src="/hanami-guides/assets/js/argon.js?v=1.0.1"></script>
  <script src="/hanami-guides/assets/js/theme.js"></script>
  
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
    apiKey: '69274449268769eb3878f6a13dd112f9',
    indexName: 'hanamirb_guides',
    inputSelector: '#search-input',
    debug: false 
  });
  </script>
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-41951932-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>
